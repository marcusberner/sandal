var Sandal=function(){"use strict";var e,n,t,r,o,i,s,c;return t=function(e,n,t,r){if("done"===n||e[n])throw new Error(n+" is already registered");if(r)for(var o=0;o<r.length;o++)!function(t){if("done"===r[t]||e[r[t]]&&!e[r[t]].isGroup)throw new Error(n+" is already registered and can not be used as group name");e[r[t]]&&e[r[t]].isGroup?e[r[t]].dependencyNames.push(n):e[r[t]]={factory:function(){for(var n={},o=0;o<e[r[t]].dependencyNames.length;o++)n[e[r[t]].dependencyNames[o]]=arguments[o];return n},lifecycle:"transient",dependencyNames:[n],isGroup:!0}}(o);e[n]=t},n=function(e){var n,t;return n=e.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),t=n.slice(n.indexOf("(")+1,n.indexOf(")")).match(/([^\s,]+)/g),null===t&&(t=[]),t},r=function(e,n){var t,r;for(r=0;r<e.length;r++)for(t=0;t<n.length;t++)if(n[t]===e[r])return!0;return!1},o=function(e,n){for(var t=0;t<n.resolvedCallbacks.length;t++)n.resolvedCallbacks[t](e);n.resolvedCallbacks=[],n.isResolving=!1},i=function(e,n){if(e.ctor){var t,r=function(){};return r.prototype=e.ctor.prototype,t=new r,e.ctor.prototype.constructor.apply(t,n),t}return e.factory.apply(null,n)},s=function(e,t,c,a){var l,f,u,d,p,y,h,v;if(c.push(e),d=t._container[e],!d&&t._internal&&t._internal.has(e))return void t._internal.resolve(e,a);if(!d)return void a(new Error("No implementation registered for "+e+(c.length<2?"":" needed for "+c.splice(c.length-2,1))));if(u=function(e,n){"singleton"===d.lifecycle?(e||(d.singleton=n),o(e,d)):a(e,n)},"singleton"===d.lifecycle){if(d.resolvedCallbacks=d.resolvedCallbacks||[],d.resolvedCallbacks.push(function(e){a(e,d.singleton)}),d.isResolving)return;if(d.isResolving=!0,d.hasOwnProperty("singleton"))return void u(null,d.singleton)}if(!d.ctor&&!d.factory)return void u(new Error("No valid implementation registered for "+e));if(d.dependencyNames=d.dependencyNames||n(d.ctor||d.factory),r(d.dependencyNames,c))return void u(new Error("There are circular dependencies in resolve chain: "+c));if(p=d.dependencyNames.length,0!==p)for(y=[],h=!1,v=0,l=0;p>l;l++)!function(e){var n=function(n,t){if(n)return void u(n);if(y[e]=t,v++,v===p){try{f=i(d,y)}catch(n){u(n)}h||u(null,f)}};return"done"===d.dependencyNames[e]?(h=!0,void(d.factory?n(null,u):n(null,function(e){setTimeout(function(){u(e,f)},0)}))):void s(d.dependencyNames[e],t,c.slice(0),n)}(l);else try{f=i(d,[]),u(null,f)}catch(g){u(g)}},c=function(e,n,t,r,o){o||(o=r,r=null);var i,s="$_tmp_",c=0;do i=s+c++;while(e.has(i));r?e[n](i,r,t):e[n](i,t),e.resolve(i,o),e.remove(i)},e=function(e){this._options=e||{},this.clear()},e.prototype.service=function(e,n,r,o,i){if(n instanceof Array||(i=o,o=r,r=n,n=null),o instanceof Array&&(i=o,o=!1),"function"!=typeof r)throw new Error('Service "'+e+'" must be a function');return t(this._container,e,{ctor:r,lifecycle:o?"transient":"singleton",dependencyNames:n},i),this},e.prototype.factory=function(e,n,r,o,i){if(n instanceof Array||(i=o,o=r,r=n,n=null),o instanceof Array&&(i=o,o=!1),"function"!=typeof r)throw new Error('Factory "'+e+'" must be a function');return t(this._container,e,{factory:r,lifecycle:o?"transient":"singleton",dependencyNames:n},i),this},e.prototype.object=function(e,n,r){return t(this._container,e,{singleton:n,lifecycle:"singleton"},r),this},e.prototype.internal=function(e){return this._internal=e,this},e.prototype.resolve=function(e,t){var r,o,i,c,a=this;if("string"==typeof e?e=[e]:"function"==typeof e&&(t=e,e=n(t),e=e.splice(1,e.length-1)),e instanceof Array||"function"==typeof t){if(r=e.length,0===r)return t();for(o=0,i=[],c=0;r>c;c++)!function(n){s(e[n],a,[],function(e,s){o++,i[0]=i[0]||e,i[n+1]=s,o===r&&t&&t.apply({},i)})}(c)}},e.prototype.resolveAsFactory=function(e,n,t){c(this,"factory",e,n,t)},e.prototype.resolveAsService=function(e,n,t){c(this,"service",e,n,t)},e.prototype.remove=function(e){var n,t,r;if(!e)return this;for("string"==typeof e&&(e=[e]),n=0;n<e.length;n++){if("sandal"===e[n]||"done"===e[n])throw new Error("Removing "+e[n]+" is not allowed");delete this._container[e[n]];for(r in this._container)if(this._container[r].isGroup)for(t in this._container[r].dependencyNames)if(this._container[r].dependencyNames[t]===e[n]){this._container[r].dependencyNames.splice(t,1);break}}return this},e.prototype.has=function(e){return!!this._container[e]},e.prototype.clear=function(){return this._container={sandal:{singleton:this,lifecycle:"singleton"}},this},e}();"undefined"!=typeof module&&module.exports&&(module.exports=Sandal);
//# sourceMappingURL=sandal-min.map