var Sandal=function(){"use strict";var n,e,r,o,t;return n=function(n){var e,r;return e=n.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),r=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(/([^\s,]+)/g),null===r&&(r=[]),r},e=function(n){for(var e=[],r=0;r<n.length;r++)e[r]=n[r];return e},r=function(r,t,i,a,c){if(r._container[t])throw new Error("There is already a component with the name "+t);if("function"!=typeof i)throw new Error("Factory or service "+t+" is not a function");var s,l,u;if(a=a||{},s=a.dependencies||n(i),(u=function(n){if(n)for(var e=0;e<n.length;e++){if(n[e]===t)throw new Error(t+" has circular dependency");r._container[n[e]]&&u(r._container[n[e]]._dependencies)}})(s),l=s.indexOf("done"),r._container[t]=function(n){var o=n;if(!a.lifecycle||"singleton"===a.lifecycle){if(r._container[t]._error)return r._error("Singleton "+t+" previously failed "),void n(r._container[t]._error);if(r._container[t].hasOwnProperty("_instance"))return r._info("Returning already resolved singleton "+t),void n(null,r._container[t]._instance);if(r._container[t]._resolvedCallbacks)return r._info("Resolving of the singleton "+t+" is in progress, waiting for completion"),void r._container[t]._resolvedCallbacks.push(n);r._container[t]._resolvedCallbacks=[n],o=function(n,e){r._info("Resolving of "+t+" done "+(n?"with":"without")+" error"),r._container[t]._error=n,r._container[t]._instance=e,r._info("Returning "+t+" to "+r._container[t]._resolvedCallbacks.length+" queued callbacks");for(var o=0;o<r._container[t]._resolvedCallbacks.length;o++)r._container[t]._resolvedCallbacks[o](n,e);r._container[t]._resolvedCallbacks=[]}}r._info("Resolving "+t+" dependencies: "+s),r.resolve(r._container[t]._dependencies,function(r){if(r)return n(r);var t=e(arguments).slice(1);try{c(i,t,l,o)}catch(r){o(r)}})},r._container[t]._dependencies=s,a.groups)for(var f=0;f<a.groups.length;f++)o(r,t,a.groups[f])},o=function(n,r,o){if(n._container[o]){if(!n._container[o]._isGroup)throw new Error("There is already a non group component with the name "+o);n._container[o]._dependencies.push(r)}else n._container[o]=function(r){var t=e(n._container[o]._dependencies);n.resolve(t,function(n){if(n)return r(n);var o,i=e(arguments).slice(1),a={};for(o=0;o<t.length;o++)a[t[o]]=i[o];r(null,a)})},n._container[o]._dependencies=[r],n._container[o]._isGroup=!0},t=function(n){n=n||{};var e=this,r=n.console||console;e._options=n,e.name=n.name||"Container "+Math.round(1e5*Math.random()),e._info=function(o){n.verbose&&r&&r.info&&r.info(e.name+": "+o)},e._error=function(o){n.verbose&&r&&r.error&&r.error(e.name+": "+o)},e.clear()},t.prototype.has=function(n){return!!this._container[n]},t.prototype.resolve=function(){var e,r,o,t,i=this,a=!1,c=0,s=[];if("string"==typeof arguments[0])e=[arguments[0]],r=arguments[1];else if(arguments[0]instanceof Array)e=arguments[0],r=arguments[1];else{if("function"!=typeof arguments[0])return;e=n(arguments[0]).slice(1),r=arguments[0]}if(i._info("Initiating resolving of "+e),o=e.length,0===o)return r(null,[]);for(t=0;o>t;t++)!function(n,t){if(!a){i._info("Resolving "+t);var l=i._container[t]?i._container[t]:function(n){return i._internal?void i._internal.resolve(t,n):(a=!0,n(new Error("No component named "+t+" registered")))};l(function(l,u){return l?(a=!0,i._error("Failed resolving "+t+": "+l.message),r(l)):void(a||(c++,s[n]=u,c===o&&(i._info("Done resolving "+e),r.apply(void 0,[l].concat(s)))))})}}(t,e[t])},t.prototype.internal=function(n){return this._info("Setting internal container to "+n.name),this._internal=n,this},t.prototype.object=function(n,e,r){var t=this;if(t._container[n])throw new Error("There is already a component with the name "+n);if(t._info("Register object "+n),t._container[n]=function(n){n(null,e)},t._container[n]._dependencies=[],r&&r.groups)for(var i=0;i<r.groups.length;i++)o(t,n,r.groups[i]);return this},t.prototype.factory=function(n,e,o){var t=this;return t._info("Register factory "+n),r(this,n,e,o,function(e,r,o,i){t._info("Applying factory "+n),o>=0?(r[o]=i,e.apply(void 0,r)):i(null,e.apply(void 0,r))}),this},t.prototype.service=function(n,e,o){var t=this;return t._info("Register service "+n),r(this,n,e,o,function(e,r,o,i){t._info("Creating service "+n);var a,c;a=function(){},a.prototype=e.prototype,c=new a,o>=0?(r[o]=function(n){return n?i(n):void i(null,c)},e.prototype.constructor.apply(c,r)):(e.prototype.constructor.apply(c,r),i(null,c))}),this},t.prototype.resolveAsFactory=function(r,o,t){t||"function"==typeof o&&(t=o,o={}),o=o||{};var i=o.dependencies||n(r);this.resolve(i,function(n){return n?t(n):void t(null,r.apply(void 0,e(arguments).slice(1)))})},t.prototype.resolveAsService=function(r,o,t){t||"function"==typeof o&&(t=o,o={}),o=o||{};var i=o.dependencies||n(r);this.resolve(i,function(n){if(n)return t(n);var o,i;o=function(){},o.prototype=r.prototype,i=new o,r.prototype.constructor.apply(i,e(arguments).slice(1)),t(null,i)})},t.prototype.remove=function(n){if(!(n instanceof Array)){if("done"===n)throw new Error("Removing done is not allowed");if("sandal"===n)throw new Error("Removing sandal is not allowed");delete this._container[n];for(var e in this._container)if(this._container[e]._isGroup){var r=this._container[e]._dependencies.indexOf(n);r>=0&&this._container[e]._dependencies.splice(r,1)}return this}for(var o=0;o<n.length;o++)this.remove(n[o])},t.prototype.clear=function(){this._info("Clearing container");var n=this;return this._container={sandal:function(e){e(null,n)},done:function(n){n(null,null)}},n},t}();module&&module.exports&&(module.exports=Sandal);
//# sourceMappingURL=sandal-min.map